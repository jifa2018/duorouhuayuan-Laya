{
  "code": "var Sprite3D = Laya.Sprite3D;\r\nvar Tween = Laya.Tween;\r\nvar Handler = Laya.Handler;\r\nvar Vector3 = Laya.Vector3;\r\nimport { Utils } from \"../../utils/Utils\";\r\nvar Point = Laya.Point;\r\nvar MouseManager = Laya.MouseManager;\r\nimport { GameUIManager } from \"../../manager/GameUIManager\";\r\nimport { StaffTimeView } from \"../ui/Staff/StaffTimeView\";\r\nvar Ease = Laya.Ease;\r\nimport { CommonDefine } from \"../../common/CommonDefine\";\r\nimport GameScene from \"../scene/GameScene\";\r\nexport class CarEditor {\r\n    constructor(scene3d) {\r\n        this._staffList = new Array();\r\n        this._t = null;\r\n        this._seat = new Array();\r\n        this._car = scene3d.getChildByName(\"bashiche_01\");\r\n        this._curPosX = this._car.transform.localPositionX;\r\n        this._door = this._car.getChildByName(\"bashiche_02\");\r\n        this._door.active = false;\r\n        this._camera = scene3d._cameraPool[0];\r\n        this._scene = scene3d;\r\n        for (let index = 1; index < 5; index++) {\r\n            this._seat.push([index, false]);\r\n        }\r\n        return;\r\n    }\r\n    refreshStaff(testcar) {\r\n        this._car.addChild(testcar);\r\n        for (let index = 0; index < this._seat.length; index++) {\r\n            const element = this._seat[index];\r\n            if (!element[1]) {\r\n                testcar.transform.localMatrix = this._car.getChildByName(\"point\" + element[0]).transform.localMatrix;\r\n                element[1] = true;\r\n                testcar.Setseat(element[0]);\r\n                break;\r\n            }\r\n        }\r\n        testcar.transform.localRotationEulerY = 90;\r\n    }\r\n    InitPos() {\r\n        return this._car.getChildByName(\"point1\").transform.position;\r\n    }\r\n    screenMove(bHome, end) {\r\n        if (this._t) {\r\n            this._t.clear();\r\n        }\r\n        if (this._curPosX > end) {\r\n            this._car.transform.scale = new Vector3(-1, 1, 1);\r\n            this._door.transform.scale = new Vector3(-1, 1, 1);\r\n        }\r\n        else {\r\n            this._car.transform.scale = new Vector3(1, 1, 1);\r\n            this._door.transform.scale = new Vector3(1, 1, 1);\r\n        }\r\n        this._door.active = true;\r\n        this._t = Tween.to(this._car.transform, { localPositionX: end }, 1000, Ease.cubicOut, Handler.create(this, function () {\r\n            this._door.active = false;\r\n            this._t = null;\r\n            if (!bHome) {\r\n                this._t = null;\r\n            }\r\n        }));\r\n        this._curPosX = end;\r\n    }\r\n    tweenMove() {\r\n        var t;\r\n        t.complete();\r\n    }\r\n    beginDrag(target) {\r\n        if (target.parent instanceof Sprite3D && GameScene.instance.curRollIndex == 1) {\r\n            this._dragTarget = target;\r\n            target.playAnimation(CommonDefine.ANIMATION_tuozhuai);\r\n            target.transform.localRotationEulerY = 180;\r\n        }\r\n    }\r\n    endDrag() {\r\n        if (!this._dragTarget)\r\n            return;\r\n        var pos = (this._dragTarget).transform.position;\r\n        this._scene.addChild(this._dragTarget);\r\n        let dataid = this._dragTarget.GetId();\r\n        GameUIManager.getInstance().showUI(StaffTimeView, Laya.Handler.create(this, (view) => {\r\n            view.SetDataID(dataid);\r\n        }));\r\n        this._dragTarget.playAnimation(CommonDefine.ANIMATION_IDLE);\r\n        let id = this._dragTarget.Getseat();\r\n        for (let index = 0; index < this._seat.length; index++) {\r\n            const e = this._seat[index];\r\n            if (e[0] == id) {\r\n                e[1] = false;\r\n                break;\r\n            }\r\n        }\r\n        this._dragTarget = null;\r\n    }\r\n    onDragMove(e) {\r\n        if (!this._dragTarget)\r\n            return;\r\n        var pos = (Utils.screenToWorld(new Point(MouseManager.instance.mouseX, MouseManager.instance.mouseY), this._camera, 0, 88.0));\r\n        (this._dragTarget).transform.position = pos;\r\n    }\r\n    canMove() {\r\n        return this._dragTarget == null;\r\n    }\r\n}\r\n//# sourceMappingURL=CarEditor.js.map",
  "references": [
    "E:/project/duorou/client/src/manager/ResourceManager.ts",
    "E:/project/duorou/client/src/game/Staff/Gatherman.ts",
    "E:/project/duorou/client/src/game/item/Tree.ts",
    "E:/project/duorou/client/src/utils/Utils.ts",
    "E:/project/duorou/client/src/manager/GameUIManager.ts",
    "E:/project/duorou/client/src/game/ui/Staff/StaffTimeView.ts",
    "E:/project/duorou/client/src/manager/StaffManager.ts",
    "E:/project/duorou/client/src/common/TImer.ts",
    "E:/project/duorou/client/src/common/CommonDefine.ts",
    "E:/project/duorou/client/src/game/scene/GameScene.ts"
  ],
  "map": "{\"version\":3,\"file\":\"CarEditor.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/game/edit/CarEditor.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
