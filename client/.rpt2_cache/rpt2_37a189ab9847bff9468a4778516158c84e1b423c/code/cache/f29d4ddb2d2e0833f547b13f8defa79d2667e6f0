{
  "code": "import { ui } from \"../../../ui/layaMaxUI\";\r\nvar IllustratedUI = ui.view.Illustrated.IllustratedUI;\r\nimport { Map_Cfg, Succulent_Cfg } from \"../../../manager/ConfigManager\";\r\nimport { GameUIManager } from \"../../../manager/GameUIManager\";\r\nimport { CommonDefine } from \"../../../common/CommonDefine\";\r\nexport class Illustrated extends IllustratedUI {\r\n    constructor(agms) {\r\n        super();\r\n        this._comp = null;\r\n        this._initListArr = [];\r\n        this._mapId = null;\r\n        this._mapLv = null;\r\n        this._mapId = agms[0] || 1;\r\n        this._mapLv = agms[1] || 1;\r\n    }\r\n    onEnable() {\r\n        this._comp = this.getComp();\r\n        let oDrop = this.getUnRepetDrop(this._comp);\r\n        this.setTitle();\r\n        this.setListArr(oDrop);\r\n        this.initList();\r\n        this.refreshList();\r\n        this.bindEvent();\r\n    }\r\n    onDestroy() {\r\n        this.btn_close.off(Laya.Event.CLICK, this, this.closeEv);\r\n        this.stage.off(CommonDefine.EVENT_ILLUSTRATED_REFRESH, this, this.refreshList);\r\n    }\r\n    bindEvent() {\r\n        this.btn_close.on(Laya.Event.CLICK, this, this.closeEv);\r\n        this.stage.on(CommonDefine.EVENT_ILLUSTRATED_REFRESH, this, this.refreshList);\r\n    }\r\n    closeEv() {\r\n        GameUIManager.getInstance().destroyUI(Illustrated);\r\n    }\r\n    setTitle() {\r\n        this.title_label.text = this._comp[1].strmapname;\r\n    }\r\n    setListArr(oDrop) {\r\n        for (const key in oDrop) {\r\n            if (Object.prototype.hasOwnProperty.call(oDrop, key)) {\r\n                const _element = oDrop[key];\r\n                let item = {};\r\n                item[\"id\"] = key;\r\n                item[\"sComp\"] = Succulent_Cfg[key];\r\n                for (const _key in _element) {\r\n                    if (Object.prototype.hasOwnProperty.call(_element, _key)) {\r\n                        const element = _element[_key];\r\n                        item[_key] = element;\r\n                    }\r\n                }\r\n                this._initListArr.push(item);\r\n            }\r\n        }\r\n    }\r\n    refreshList() {\r\n        this.list.array = this._initListArr;\r\n    }\r\n    initList() {\r\n        this.list.array = [];\r\n        this.list.vScrollBarSkin = \"\";\r\n        this.list.renderHandler = Laya.Handler.create(this, this.renderHandler, null, false);\r\n        this.list.mouseHandler = Laya.Handler.create(this, this.mouseHandler, null, false);\r\n    }\r\n    renderHandler(cell) {\r\n        let img = cell.getChildByName(\"list_item_img\");\r\n        let la_lockcon = cell.getChildByName(\"la_lockcon\");\r\n        img.skin = cell.dataSource.sComp.striconurl;\r\n        if (cell.dataSource.mapLevel > this._mapLv) {\r\n            img.gray = true;\r\n            la_lockcon.skin = \"gameui/lock.png\";\r\n        }\r\n        else {\r\n            img.gray = false;\r\n            la_lockcon.skin = \"gameui/cancollect.png\";\r\n        }\r\n        cell.getChildByName(\"label_name\").text = cell.dataSource.sComp.strname;\r\n    }\r\n    mouseHandler(e) {\r\n        let dataSource = e.currentTarget.dataSource;\r\n        let img = e.currentTarget.getChildByName(\"list_item_img\");\r\n        if (e.type == \"click\") {\r\n            this.setTip(false);\r\n            let text = \"\";\r\n            let _pos = e.target.localToGlobal(new Laya.Point(img.x, img.y));\r\n            let pos = _pos;\r\n            if (img.gray) {\r\n                text = dataSource.sComp.strname + \" 开放\" + dataSource.strDoc + \"区域解锁\";\r\n            }\r\n            else {\r\n                text = dataSource.sComp.strname;\r\n            }\r\n            this.setTip(true, text, pos);\r\n        }\r\n    }\r\n    getUnRepetDrop(dComp) {\r\n        let dropMap = {};\r\n        for (const key in dComp) {\r\n            if (Object.prototype.hasOwnProperty.call(dComp, key)) {\r\n                const element = dComp[key];\r\n                let arrSidgroup = element.strSidgroup.split(\"|\");\r\n                let strdrop = element.strdrop.split(\"|\");\r\n                strdrop.forEach((e, i) => {\r\n                    if (!dropMap[e]) {\r\n                        dropMap[e] = element;\r\n                    }\r\n                });\r\n                arrSidgroup.forEach((e, i) => {\r\n                    if (!dropMap[e]) {\r\n                        dropMap[e] = element;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        return dropMap;\r\n    }\r\n    getComp() {\r\n        let _comp = {};\r\n        for (const key in Map_Cfg) {\r\n            if (Object.prototype.hasOwnProperty.call(Map_Cfg, key)) {\r\n                const element = Map_Cfg[key];\r\n                if (element.mapid == this._mapId) {\r\n                    _comp[key] = element;\r\n                }\r\n            }\r\n        }\r\n        return _comp;\r\n    }\r\n    setTip(isShow, text, pos) {\r\n        this.tip.visible = isShow;\r\n        if (isShow == false) {\r\n            Laya.timer.clearAll(this);\r\n            return;\r\n        }\r\n        this.tip.pos(pos.x - 50, pos.y - 60);\r\n        this.tipTxt.text = text;\r\n        Laya.timer.once(1500, this, () => {\r\n            this.tip.visible = false;\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=Illustrated.js.map",
  "references": [
    "E:/project/duorou/client/src/ui/layaMaxUI.ts",
    "E:/project/duorou/client/src/manager/ConfigManager.ts",
    "E:/project/duorou/client/src/manager/GameUIManager.ts",
    "E:/project/duorou/client/src/game/item/Point.ts",
    "E:/project/duorou/client/src/common/CommonDefine.ts"
  ],
  "map": "{\"version\":3,\"file\":\"Illustrated.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/game/ui/Illustrated/Illustrated.ts\"],\"names\":[],\"mappings\":\"AAKA,OAAO,EAAE,EAAE,EAAE,MAAM,uBAAuB,CAAC;AAC3C,IAAO,aAAa,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAA;AACxD,OAAO,EAAE,OAAO,EAAE,aAAa,EAAE,MAAM,gCAAgC,CAAC;AACxE,OAAO,EAAE,aAAa,EAAE,MAAM,gCAAgC,CAAC;AAE/D,OAAO,EAAE,YAAY,EAAE,MAAM,8BAA8B,CAAC;AAE5D,MAAM,OAAO,WAAY,SAAQ,aAAa;IAM1C,YAAY,IAAI;QACZ,KAAK,EAAE,CAAA;QALH,UAAK,GAAG,IAAI,CAAC;QACb,iBAAY,GAAG,EAAE,CAAC;QAClB,WAAM,GAAG,IAAI,CAAC;QACd,WAAM,GAAG,IAAI,CAAC;QAGlB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;QAC3B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;IAC/B,CAAC;IAED,QAAQ;QACJ,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,EAAE,CAAA;QAC3B,IAAI,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC5C,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;QACvB,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,SAAS,EAAE,CAAC;IACrB,CAAC;IAED,SAAS;QACL,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;QACxD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,yBAAyB,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;IAClF,CAAC;IAED,SAAS;QACL,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;QACvD,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,yBAAyB,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAA;IACjF,CAAC;IAED,OAAO;QACH,aAAa,CAAC,WAAW,EAAE,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;IACvD,CAAC;IAED,QAAQ;QACJ,IAAI,CAAC,WAAW,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,CAAA;IACpD,CAAC;IAED,UAAU,CAAC,KAAK;QACZ,KAAK,MAAM,GAAG,IAAI,KAAK,EAAE;YACrB,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,EAAE;gBAClD,MAAM,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;gBAC5B,IAAI,IAAI,GAAG,EAAE,CAAA;gBACb,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;gBACjB,IAAI,CAAC,OAAO,CAAC,GAAG,aAAa,CAAC,GAAG,CAAC,CAAC;gBACnC,KAAK,MAAM,IAAI,IAAI,QAAQ,EAAE;oBACzB,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,EAAE;wBACtD,MAAM,OAAO,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC;wBAC/B,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,CAAA;qBACvB;iBACJ;gBACD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aAChC;SACJ;IAEL,CAAC;IAED,WAAW;QACP,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAA;IACvC,CAAC;IAED,QAAQ;QACJ,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,EAAE,CAAA;QACpB,IAAI,CAAC,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;QAC9B,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,EAAE,KAAK,CAAC,CAAA;QACpF,IAAI,CAAC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,EAAE,KAAK,CAAC,CAAA;IACtF,CAAC;IAED,aAAa,CAAC,IAAc;QACxB,IAAI,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,eAAe,CAAe,CAAC;QAC7D,IAAI,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,CAAe,CAAC;QACjE,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,UAAU,CAAA;QAC3C,IAAI,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,EAAE;YACxC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC;YAChB,UAAU,CAAC,IAAI,GAAG,iBAAiB,CAAC;SACvC;aAAM;YACH,GAAG,CAAC,IAAI,GAAG,KAAK,CAAC;YACjB,UAAU,CAAC,IAAI,GAAG,uBAAuB,CAAC;SAC7C;QACA,IAAI,CAAC,cAAc,CAAC,YAAY,CAAgB,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,OAAO,CAAA;IAC1F,CAAC;IAED,YAAY,CAAC,CAAa;QACtB,IAAI,UAAU,GAAI,CAAC,CAAC,aAA0B,CAAC,UAAU,CAAA;QACzD,IAAI,GAAG,GAAI,CAAC,CAAC,aAA0B,CAAC,cAAc,CAAC,eAAe,CAAe,CAAC;QACtF,IAAI,CAAC,CAAC,IAAI,IAAI,OAAO,EAAE;YACnB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAA;YAClB,IAAI,IAAI,GAAG,EAAE,CAAC;YACd,IAAI,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;YAC/D,IAAI,GAAG,GAAG,IAAI,CAAA;YACd,IAAI,GAAG,CAAC,IAAI,EAAE;gBACV,IAAI,GAAG,UAAU,CAAC,KAAK,CAAC,OAAO,GAAG,KAAK,GAAG,UAAU,CAAC,MAAM,GAAG,MAAM,CAAC;aACxE;iBAAM;gBACH,IAAI,GAAG,UAAU,CAAC,KAAK,CAAC,OAAO,CAAC;aACnC;YACD,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,EAAE,GAAG,CAAC,CAAA;SAC/B;IAEL,CAAC;IAGD,cAAc,CAAC,KAAK;QAChB,IAAI,OAAO,GAAG,EAAE,CAAC;QACjB,KAAK,MAAM,GAAG,IAAI,KAAK,EAAE;YACrB,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,EAAE;gBAClD,MAAM,OAAO,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;gBAC3B,IAAI,WAAW,GAAI,OAAO,CAAC,WAAsB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAC7D,IAAI,OAAO,GAAI,OAAO,CAAC,OAAkB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBACrD,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;oBACrB,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;wBACb,OAAO,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC;qBACxB;gBACL,CAAC,CAAC,CAAC;gBACH,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;oBACzB,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;wBACb,OAAO,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC;qBACxB;gBACL,CAAC,CAAC,CAAA;aACL;SACJ;QACD,OAAO,OAAO,CAAC;IACnB,CAAC;IAGD,OAAO;QACH,IAAI,KAAK,GAAG,EAAE,CAAC;QACf,KAAK,MAAM,GAAG,IAAI,OAAO,EAAE;YACvB,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC,EAAE;gBACpD,MAAM,OAAO,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;gBAC7B,IAAI,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,MAAM,EAAE;oBAC9B,KAAK,CAAC,GAAG,CAAC,GAAG,OAAO,CAAC;iBACxB;aACJ;SACJ;QACD,OAAO,KAAK,CAAA;IAChB,CAAC;IAQD,MAAM,CAAC,MAAM,EAAE,IAAK,EAAE,GAAI;QACtB,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,MAAM,CAAC;QAC1B,IAAI,MAAM,IAAI,KAAK,EAAE;YACjB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;YACzB,OAAM;SACT;QACD,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;QACrC,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC;QAGxB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE;YAC7B,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,KAAK,CAAA;QAC5B,CAAC,CAAC,CAAA;IAEN,CAAC;CAEJ\"}"
}
