{
  "code": "import { ui } from \"../../../ui/layaMaxUI\";\r\nimport { Staff_Cfg, Succulent_Cfg } from \"../../../manager/ConfigManager\";\r\nimport { StaffManager } from \"../../../manager/StaffManager\";\r\nimport { Utils } from \"../../../utils/Utils\";\r\nimport { Timer } from \"../../../common/TImer\";\r\nimport { GameUIManager } from \"../../../manager/GameUIManager\";\r\nimport { GameData } from \"../../data/GameData\";\r\nimport { SaveManager, ModelStorage } from \"../../../manager/SaveManager\";\r\nimport { ViewManager } from \"../../../manager/ViewManager\";\r\nimport { GEvent } from \"../../../common/GEvent\";\r\nimport { GacEvent } from \"../../../common/GacEvent\";\r\nimport { EffectManager } from \"../../../effect/EffectManager\";\r\nexport class StaffCommonView extends ui.view.StaffCommonViewUI {\r\n    constructor() {\r\n        super();\r\n        this._goodIndex = 0;\r\n        this.timeVoid = null;\r\n        this.createView(Laya.loader.getRes(\"view/StaffCommonView.json\"));\r\n    }\r\n    onEnable() {\r\n        this.width = Laya.stage.width;\r\n        this.height = Laya.stage.height;\r\n        this.onInit();\r\n        this.onEvent();\r\n    }\r\n    onDisable() {\r\n        this.offAll();\r\n        this.ui_sure_button.off(Laya.Event.CLICK, this, this.SureClick);\r\n        this.ui_close_button.off(Laya.Event.CLICK, this, () => {\r\n            GameUIManager.getInstance().hideUI(StaffCommonView);\r\n        });\r\n    }\r\n    onInit() {\r\n    }\r\n    onEvent() {\r\n        this.ui_sure_button.on(Laya.Event.CLICK, this, this.SureClick);\r\n        this.ui_close_button.on(Laya.Event.CLICK, this, () => {\r\n            GameUIManager.getInstance().hideUI(StaffCommonView);\r\n        });\r\n    }\r\n    GetRoleMessageList() {\r\n        this.ui_good_list.array = GameData.GetItem(Staff_Cfg[this._goodIndex][\"staffID\"]);\r\n        this.ui_good_list.renderHandler = new Laya.Handler(this, this.SetRoleMessageList);\r\n    }\r\n    SetRoleMessageList(box, index) {\r\n        let GoodPic = box.getChildByName(\"good_pic\");\r\n        let GoodNum = box.getChildByName(\"good_num\");\r\n        let GoodName = box.getChildByName(\"good_name\");\r\n        let array = GameData.GetItem(Staff_Cfg[this._goodIndex][\"staffID\"])[index];\r\n        GoodPic.skin = Succulent_Cfg[array[1]][\"striconurl\"];\r\n        GoodNum.text = \"X\" + array[0];\r\n        GoodName.text = \"\" + Succulent_Cfg[array[1]][\"strname\"];\r\n    }\r\n    SetDataID(index = -1) {\r\n        this._goodIndex = index;\r\n        let value = SaveManager.getInstance().GetCache(ModelStorage.Staff);\r\n        for (let i = 0; i < value.length; i++) {\r\n            if (this._goodIndex == value[i][\"id\"]) {\r\n                if (value[i][\"workState\"] == 1 && Staff_Cfg[value[i][\"id\"]][\"jobID\"] == 4) {\r\n                    this.ui_time_font.visible = true;\r\n                    let time = StaffManager.getInstance().GetCollectTime(Staff_Cfg[value[i][\"id\"]][\"staffID\"]);\r\n                    this.ui_time_font.text = \"剩余采集时间：\" + Utils.TimeToTimeFormat(time);\r\n                    this.ui_tips_font.skin = \"gameui/staffcommon/staffingfont.png\";\r\n                    this.ui_sure_button.visible = false;\r\n                    this.UpdateTime();\r\n                }\r\n                else if (value[i][\"workState\"] == 3 && Staff_Cfg[value[i][\"id\"]][\"jobID\"] == 4) {\r\n                    this.ui_time_font.visible = false;\r\n                    this.ui_tips_font.skin = \"gameui/staffcommon/stafffont.png\";\r\n                    this.ui_sure_button.visible = true;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        this.GetRoleMessageList();\r\n    }\r\n    SureClick() {\r\n        EffectManager.getInstance().BtnEffect(this.ui_sure_button);\r\n        StaffManager.getInstance().ToRest(Staff_Cfg[this._goodIndex][\"staffID\"]);\r\n        GEvent.DispatchEvent(GacEvent.RefreshGatherInfo);\r\n        +GameUIManager.getInstance().hideUI(StaffCommonView);\r\n    }\r\n    UpdateTime() {\r\n        if (this.timeVoid == null) {\r\n            this.timeVoid = Timer.Loop(1000, this, this.UpdateTimeCD);\r\n        }\r\n    }\r\n    UpdateTimeCD() {\r\n        let value = SaveManager.getInstance().GetCache(ModelStorage.Staff);\r\n        let bool = false;\r\n        for (const key of value) {\r\n            if (key[\"workState\"] == 1) {\r\n                bool = true;\r\n                break;\r\n            }\r\n        }\r\n        if (bool == false) {\r\n            Timer.Clear(this, this.UpdateTimeCD);\r\n            this.timeVoid = null;\r\n            this.TimeRefresh();\r\n        }\r\n        else {\r\n            this.TimeRefresh();\r\n        }\r\n    }\r\n    TimeRefresh() {\r\n        let value = SaveManager.getInstance().GetCache(ModelStorage.Staff);\r\n        for (let i = 0; i < value.length; i++) {\r\n            if (this._goodIndex == value[i][\"id\"]) {\r\n                if (value[i][\"workState\"] == 1 && Staff_Cfg[value[i][\"id\"]][\"jobID\"] == 4) {\r\n                    this.ui_time_font.visible = true;\r\n                    let time = StaffManager.getInstance().GetCollectTime(Staff_Cfg[value[i][\"id\"]][\"staffID\"]);\r\n                    this.ui_time_font.text = \"剩余采集时间：\" + Utils.TimeToTimeFormat(time);\r\n                    this.ui_tips_font.skin = \"gameui/staffcommon/staffingfont.png\";\r\n                    this.ui_sure_button.visible = false;\r\n                    this.UpdateTime();\r\n                }\r\n                else if (value[i][\"workState\"] == 3 && Staff_Cfg[value[i][\"id\"]][\"jobID\"] == 4) {\r\n                    this.ui_time_font.visible = false;\r\n                    this.ui_tips_font.skin = \"gameui/staffcommon/stafffont.png\";\r\n                    this.ui_sure_button.visible = true;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        this.ui_good_list.array = GameData.GetItem(Staff_Cfg[this._goodIndex][\"staffID\"]);\r\n    }\r\n}\r\nViewManager.getInstance().SaveViewResUrl(StaffCommonView, [\r\n    { url: \"view/StaffCommonView.json\", type: Laya.Loader.JSON },\r\n]);\r\n//# sourceMappingURL=StaffCommonView.js.map",
  "references": [
    "E:/project/duorou/client/src/ui/layaMaxUI.ts",
    "E:/project/duorou/client/src/manager/ConfigManager.ts",
    "E:/project/duorou/client/src/manager/StaffManager.ts",
    "E:/project/duorou/client/src/utils/Utils.ts",
    "E:/project/duorou/client/src/common/TImer.ts",
    "E:/project/duorou/client/src/manager/GameUIManager.ts",
    "E:/project/duorou/client/src/game/data/GameData.ts",
    "E:/project/duorou/client/src/manager/SaveManager.ts",
    "E:/project/duorou/client/src/manager/ViewManager.ts",
    "E:/project/duorou/client/src/common/GEvent.ts",
    "E:/project/duorou/client/src/common/GacEvent.ts",
    "E:/project/duorou/client/src/effect/EffectManager.ts"
  ],
  "map": "{\"version\":3,\"file\":\"StaffCommonView.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/game/ui/Staff/StaffCommonView.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
