{
  "code": "import { Singleton } from \"../common/Singleton\";\r\nimport { Succulentpoint_Cfg, Constant_Cfg } from \"./ConfigManager\";\r\nimport { PotState } from \"../game/GameDefine\";\r\nimport { Point } from \"../game/item/Point\";\r\nimport { Time } from \"../common/Time\";\r\nimport GameScene from \"../game/scene/GameScene\";\r\nimport { GameUIManager } from \"./GameUIManager\";\r\nimport { FlowerRipeTipsView } from \"../game/ui/FlowerState/FlowerRipeTipsView\";\r\nimport { SaveManager, ModelStorage } from \"./SaveManager\";\r\nimport { GEvent } from \"../common/GEvent\";\r\nimport { GacEvent } from \"../common/GacEvent\";\r\nexport class PotManager extends Singleton {\r\n    constructor() {\r\n        super();\r\n        this.PotMap = {};\r\n        this.PotRipeList = [];\r\n        this.scaleInfo = { \"1\": [0.24, 1], \"2\": [0.3, 1.7], \"3\": [0.5, 1.9] };\r\n        this.initData();\r\n    }\r\n    initData() {\r\n        for (const key in ModelStorage) {\r\n            let strName = ModelStorage[key];\r\n            if (ModelStorage[key].indexOf(\"defaulsucculent\") != -1) {\r\n                var _data = SaveManager.getInstance().GetCache(strName);\r\n                if (_data) {\r\n                    let point = new Point();\r\n                    point.initPoint(_data, null);\r\n                    let pointName = strName.substr(6, strName.length - 1);\r\n                    this.PotMap[pointName] = point;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    AddPot(point, potid, pot) {\r\n        if (!this.PotMap[point]) {\r\n            this.PotMap[point] = new Point();\r\n            let _data = {};\r\n            _data[\"Name\"] = point;\r\n            _data[\"UseIndex\"] = potid;\r\n            this.PotMap[point].initPoint(_data, null);\r\n        }\r\n        pot.State = PotState.Grow;\r\n        pot.GrowStartTime = Time.Seconds;\r\n        pot.GrowTime = Constant_Cfg[8].value;\r\n        this.PotMap[point].PotList[potid] = pot;\r\n        this.PotMap[point].UseIndex = potid;\r\n        this.PotMap[point].packData();\r\n    }\r\n    OnSpeedUp(point, index) {\r\n        if (!this.PotMap[point] || !this.PotMap[point].PotList[index]) {\r\n            return;\r\n        }\r\n        let pot = this.PotMap[point].PotList[index];\r\n        pot.State = PotState.Ripe;\r\n        pot.GrowStartTime = 0;\r\n        pot.GrowTime = 0;\r\n        this.PotMap[point].packData();\r\n        GameScene.instance.createSceneBotany();\r\n        this.PotRipeList.push([point, index]);\r\n        if (this.PotMap[point].growProBar) {\r\n            this.PotMap[point].growProBar.destroy();\r\n        }\r\n        GameUIManager.getInstance().showUI(FlowerRipeTipsView);\r\n        GEvent.DispatchEvent(GacEvent.OnPlantRipe);\r\n    }\r\n    DelPot(point, index) {\r\n        if (!this.PotMap[point]) {\r\n            return;\r\n        }\r\n        let tPoint = this.PotMap[point];\r\n        if (tPoint.UseIndex == index) {\r\n            GameScene.instance.delPotted(tPoint, \"point_\" + tPoint.Name, index);\r\n        }\r\n        tPoint.DelPot(index);\r\n        tPoint.packData();\r\n    }\r\n    GetPotMaxPost(point) {\r\n        return Succulentpoint_Cfg[point].ministorage || 0 + (this.PotMap[point] ? this.PotMap[point].ExpansionNum : 0);\r\n    }\r\n    GetPointCurPotIndex(point) {\r\n        if (!this.PotMap[point])\r\n            return -1;\r\n        return this.PotMap[point].UseIndex;\r\n    }\r\n    GetPointCurPot(point) {\r\n        if (!this.PotMap[point] || !this.PotMap[point].PotList[this.PotMap[point].UseIndex])\r\n            return;\r\n        return this.PotMap[point].PotList[this.PotMap[point].UseIndex];\r\n    }\r\n    ReplaceCurUse(point, index) {\r\n        if (!this.PotMap[point])\r\n            return;\r\n        let tPoint = this.PotMap[point];\r\n        tPoint.UseIndex = index;\r\n        tPoint.packData();\r\n        GameScene.instance.createPotted(tPoint, \"point_\" + tPoint.Name, index);\r\n    }\r\n    UpdateScenePot(point, index) {\r\n        if (!this.PotMap[point] || !this.PotMap[point].PointDataList[index])\r\n            return;\r\n        let tPoint = this.PotMap[point];\r\n        tPoint.PointDataList[index].State = PotState.Ripe;\r\n        tPoint.PointDataList[index].GrowStartTime = 0;\r\n        tPoint.PointDataList[index].GrowTime = 0;\r\n        tPoint.packData(tPoint.PointDataList[index], index);\r\n        GameScene.instance.createPotted(tPoint, \"point_\" + tPoint.Name, index);\r\n        this.PotRipeList.push([point, index]);\r\n        GameUIManager.getInstance().showUI(FlowerRipeTipsView);\r\n        GEvent.DispatchEvent(GacEvent.OnPlantRipe);\r\n    }\r\n    SavePot(point, potid, pot) {\r\n        if (!this.PotMap[point] || !this.PotMap[point].PotList[potid]) {\r\n            return;\r\n        }\r\n        this.PotMap[point].PotList[potid] = pot;\r\n        this.PotMap[point].packData();\r\n    }\r\n    GetPottedQuiteImg() {\r\n    }\r\n    PackageData() {\r\n        for (const key in this.PotMap) {\r\n            this.PotMap[key].packData();\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=PotManager.js.map",
  "references": [
    "E:/project/duorou/client/src/common/Singleton.ts",
    "E:/project/duorou/client/src/game/item/Potted.ts",
    "E:/project/duorou/client/src/manager/ConfigManager.ts",
    "E:/project/duorou/client/src/utils/Utils.ts",
    "E:/project/duorou/client/src/game/GameDefine.ts",
    "E:/project/duorou/client/src/common/CommonDefine.ts",
    "E:/project/duorou/client/src/game/item/Point.ts",
    "E:/project/duorou/client/src/common/Time.ts",
    "E:/project/duorou/client/src/game/scene/GameScene.ts",
    "E:/project/duorou/client/src/manager/GameUIManager.ts",
    "E:/project/duorou/client/src/game/ui/FlowerState/FlowerRipeTipsView.ts",
    "E:/project/duorou/client/src/manager/SaveManager.ts",
    "E:/project/duorou/client/src/common/GEvent.ts",
    "E:/project/duorou/client/src/common/GacEvent.ts"
  ],
  "map": "{\"version\":3,\"file\":\"PotManager.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/manager/PotManager.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
