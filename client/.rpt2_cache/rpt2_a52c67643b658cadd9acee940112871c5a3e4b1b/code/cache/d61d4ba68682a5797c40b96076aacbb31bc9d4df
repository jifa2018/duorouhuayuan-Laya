{
  "code": "import { Utils } from \"../../utils/Utils\";\r\nimport { Staff_Cfg } from \"../../manager/ConfigManager\";\r\nimport { Time } from \"../../common/Time\";\r\nimport { BagSystem } from \"../bag/BagSystem\";\r\nimport { SaveManager, ModelStorage } from \"../../manager/SaveManager\";\r\nexport class GameData {\r\n    static onInit() {\r\n        this.LoadInfo();\r\n    }\r\n    onDestroy() { }\r\n    static ChangUpGrade(tableID) {\r\n        let data = this.GetRole(tableID);\r\n        data.updateState = 1;\r\n        data.updateTimeStamp = Time.serverSeconds;\r\n        SaveManager.getInstance().SetStaffCache(this._roleInfo);\r\n    }\r\n    static upgrade(beforeId, laterId) {\r\n        let data = this.GetRole(beforeId);\r\n        if (data.id == beforeId) {\r\n            data.id = laterId;\r\n            data.updateState = 0;\r\n            data.updateTimeStamp = 0;\r\n            SaveManager.getInstance().SetStaffCache(this._roleInfo);\r\n        }\r\n    }\r\n    static InitStaffID(id, dataIndex) {\r\n        if (dataIndex != -1) {\r\n            let array = this._roleInfo;\r\n            array[dataIndex][\"id\"] = id;\r\n            this._roleInfo = array;\r\n            SaveManager.getInstance().SetStaffCache(array);\r\n        }\r\n    }\r\n    static get RoleInfo() {\r\n        return this._roleInfo;\r\n    }\r\n    static set RoleInfo(a) {\r\n        this._roleInfo = a;\r\n    }\r\n    static GetRole(nID) {\r\n        for (let i in this._roleInfo) {\r\n            if (nID == this._roleInfo[i].id) {\r\n                return this._roleInfo[i];\r\n            }\r\n        }\r\n    }\r\n    static LoadInfo() {\r\n        let value = SaveManager.getInstance().GetCache(ModelStorage.Staff);\r\n        if (value) {\r\n            this._roleInfo = value;\r\n        }\r\n        else {\r\n            let idunm = Utils.GetTableLength(Staff_Cfg);\r\n            let staffunm = Staff_Cfg[idunm].staffID;\r\n            for (let i = 1; i <= staffunm; i++) {\r\n                for (let j = 1; j <= idunm; j++) {\r\n                    if (Staff_Cfg[j][\"staffID\"] == i) {\r\n                        let data = {\r\n                            id: 0,\r\n                            updateState: 0,\r\n                            workState: 0,\r\n                            updateTimeStamp: 0,\r\n                            workTimeStamp: 0,\r\n                            restTimeStamp: 0,\r\n                            workOrRestTimeCD: 0\r\n                        };\r\n                        this._roleInfo.push(data);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            SaveManager.getInstance().SetStaffCache(this._roleInfo);\r\n        }\r\n        let da = SaveManager.getInstance().GetCache(ModelStorage.Tree);\r\n        if (da) {\r\n            this._treeInfo = da;\r\n        }\r\n    }\r\n    static get ItemInfo() {\r\n        return this._treeInfo;\r\n    }\r\n    static set ItemInfo(a) {\r\n        this._treeInfo = a;\r\n    }\r\n    static GetItem(staffId) {\r\n        return this._treeInfo[staffId];\r\n    }\r\n    static AddItem(staffId, itemId) {\r\n        if (!staffId && !itemId) {\r\n            return;\r\n        }\r\n        if (this._treeInfo && this._treeInfo[staffId]) {\r\n            let array = this._treeInfo[staffId];\r\n            for (const key in array) {\r\n                if (Object.prototype.hasOwnProperty.call(array, key)) {\r\n                    const element = array[key];\r\n                    if (element[1] == itemId) {\r\n                        element[0] += 1;\r\n                        this.SaveTree(this._treeInfo);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        let array = this._treeInfo[staffId];\r\n        if (array) {\r\n            array.push([1, itemId]);\r\n            this._treeInfo[staffId] = array;\r\n        }\r\n        else {\r\n            let DataList = new Array();\r\n            DataList.push([1, itemId]);\r\n            this._treeInfo[staffId] = DataList;\r\n        }\r\n        this.SaveTree(this._treeInfo);\r\n    }\r\n    static ClearItem(staffID) {\r\n        let array = this._treeInfo[staffID];\r\n        if (array) {\r\n            array.forEach(element => {\r\n                BagSystem.getInstance().addItem(element[1], element[0]);\r\n            });\r\n        }\r\n        this._treeInfo[staffID] = null;\r\n        this.SaveTree(this._treeInfo);\r\n    }\r\n    static SaveTree(array) {\r\n        SaveManager.getInstance().SetTreeCache(array);\r\n    }\r\n}\r\nGameData._roleInfo = [];\r\nGameData._treeInfo = {};\r\n//# sourceMappingURL=GameData.js.map",
  "references": [
    "E:/project/duorou/client/src/utils/Utils.ts",
    "E:/project/duorou/client/src/manager/ConfigManager.ts",
    "E:/project/duorou/client/src/common/Time.ts",
    "E:/project/duorou/client/src/game/bag/BagSystem.ts",
    "E:/project/duorou/client/src/manager/SaveManager.ts"
  ],
  "map": "{\"version\":3,\"file\":\"GameData.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/game/data/GameData.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
