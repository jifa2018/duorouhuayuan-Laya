{
  "code": "var Tween = Laya.Tween;\r\nvar Handler = Laya.Handler;\r\nimport GameScene from \"./scene/GameScene\";\r\nimport MouseController from \"./script/MouseController\";\r\nimport { CommonDefine } from \"../common/CommonDefine\";\r\nimport { SceneManager } from \"../manager/SceneManager\";\r\nimport ViewScene from \"./scene/ViewScene\";\r\nimport { GameUIManager } from \"../manager/GameUIManager\";\r\nimport { SceneRayChecker } from \"./ray/SceneRayChecker\";\r\nimport { LoadingScenes } from \"./ui/LoadingScenes\";\r\nexport class CameraAnimation {\r\n    constructor() {\r\n        this.inView = false;\r\n        this.durationTime = 600;\r\n        Laya.stage.on(CommonDefine.EVENT_CLICK_TARGET, this, this.beginView);\r\n        Laya.stage.on(CommonDefine.EVENT_ROLL_BACK, this, this.endView);\r\n    }\r\n    beginView() {\r\n        GameUIManager.getInstance().showUI(LoadingScenes);\r\n        SceneManager.getInstance().openScene(ViewScene.instance);\r\n        Laya.stage.event(CommonDefine.EVENT_BEGIN_VIEW);\r\n        return;\r\n        if (this.isMoving || this.nearView)\r\n            return;\r\n        console.log(\"beginview!!\");\r\n        Laya.stage.event(CommonDefine.EVENT_BEGIN_VIEW);\r\n        this.isMoving = true;\r\n        var camera = GameScene.instance.camera;\r\n        this.mouseScript = camera.getComponent(MouseController);\r\n        this.mouseScript.moveEnable = false;\r\n        this.mouseScript.rotateEnable = true;\r\n        this.mouseScript.scaleEnable = true;\r\n        this.position = camera.transform.position.clone();\r\n        this.test = camera.transform.rotation.clone();\r\n        this.camera = camera;\r\n        console.log(\"--position\");\r\n        console.log(this.position);\r\n        console.log(\"--parent rotation\");\r\n        console.log(this.rotation);\r\n        console.log(\"--rotation\");\r\n        console.log(this.test);\r\n        this.qu = camera.transform.worldMatrix.clone();\r\n        var cameraNode = GameScene.instance.getScene().getChildByName(\"Camera_node\");\r\n        var pos = cameraNode.transform.position.clone();\r\n        var rot = cameraNode.transform.rotationEuler.clone();\r\n        this.size = camera.orthographicVerticalSize;\r\n        Tween.to(this.camera.transform.position, {\r\n            x: pos.x, y: pos.y, z: pos.z, update: new Handler(this, function () {\r\n                this.camera.transform.position = this.camera.transform.position;\r\n            })\r\n        }, this.durationTime);\r\n        Tween.to(this.camera.parent.transform.rotationEuler, {\r\n            x: rot.x, y: rot.y, z: rot.z, update: new Handler(this, function () {\r\n                this.camera.transform.rotationEuler = this.camera.transform.rotationEuler;\r\n            })\r\n        }, this.durationTime);\r\n        Tween.to(this.camera, { orthographicVerticalSize: 5 }, this.durationTime, null, new Handler(this, function () {\r\n            this.nearView = true;\r\n            this.isMoving = false;\r\n        }));\r\n    }\r\n    endView() {\r\n        SceneManager.getInstance().openScene(GameScene.instance);\r\n        Laya.stage.event(CommonDefine.EVENT_END_VIEW);\r\n        return;\r\n        if (this.isMoving)\r\n            return;\r\n        Laya.stage.event(CommonDefine.EVENT_END_VIEW);\r\n        this.isMoving = true;\r\n        this.mouseScript.moveEnable = true;\r\n        this.mouseScript.rotateEnable = false;\r\n        this.mouseScript.scaleEnable = false;\r\n        Tween.to(this.camera.transform.position, {\r\n            x: this.position.x, y: this.position.y, z: this.position.z, update: new Handler(this, function () {\r\n                this.camera.transform.position = this.camera.transform.position;\r\n            })\r\n        }, this.durationTime, null, Handler.create(this, function () {\r\n            console.log(\"position\");\r\n            console.log(this.camera.transform.position);\r\n        }));\r\n        if (this.camera.parent.transform.rotation.x != this.rotation.x || this.camera.parent.transform.rotation.y != this.rotation.y ||\r\n            this.camera.parent.transform.rotation.z != this.rotation.z || this.camera.parent.transform.rotation.w != this.rotation.w) {\r\n            Tween.to(this.camera.parent.transform.rotation, {\r\n                x: this.rotation.x, y: this.rotation.y, z: this.rotation.z, w: this.rotation.w, update: new Handler(this, function () {\r\n                    this.camera.parent.transform.rotation = this.camera.parent.transform.rotation;\r\n                })\r\n            }, this.durationTime, null, Handler.create(this, function () {\r\n                console.log(\"parent rotation\");\r\n                console.log(this.camera.parent.transform.rotation);\r\n            }));\r\n            Tween.to(this.camera.transform.rotation, {\r\n                x: this.test.x, y: this.test.y, z: this.test.z, w: this.test.w, update: new Handler(this, function () {\r\n                    this.camera.transform.rotation = this.camera.transform.rotation;\r\n                })\r\n            }, this.durationTime, null, Handler.create(this, function () {\r\n                console.log(\"rotation\");\r\n                console.log(this.camera.transform.rotation);\r\n            }));\r\n        }\r\n        Tween.to(this.camera, { orthographicVerticalSize: this.size }, this.durationTime, null, new Handler(this, function () {\r\n            this.nearView = false;\r\n            this.isMoving = false;\r\n            console.log(\"---------------  orthographicVerticalSize\");\r\n            console.log(this.camera.orthographicVerticalSize);\r\n        }));\r\n    }\r\n    rollScreen(direction, camera) {\r\n        if (SceneRayChecker.getInstance().disabledHit)\r\n            return;\r\n        if (direction == \"right\" && GameScene.instance.canMove(\"right\")) {\r\n            Tween.to(camera.transform.position, {\r\n                x: 9.89, update: new Handler(this, function () {\r\n                    camera.transform.position = camera.transform.position;\r\n                })\r\n            }, 200);\r\n        }\r\n        else if (direction == \"left\" && GameScene.instance.canMove(\"left\")) {\r\n            Laya.stage.event(CommonDefine.EVENT_BEGIN_ROLL);\r\n            Tween.to(camera.transform.position, {\r\n                x: -7.76, update: new Handler(this, function () {\r\n                    camera.transform.position = camera.transform.position;\r\n                })\r\n            }, 200);\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=CameraAnimation.js.map",
  "references": [
    "E:/project/duorou/client/src/game/scene/GameScene.ts",
    "E:/project/duorou/client/src/game/script/MouseController.ts",
    "E:/project/duorou/client/src/common/CommonDefine.ts",
    "E:/project/duorou/client/src/manager/SceneManager.ts",
    "E:/project/duorou/client/src/game/scene/ViewScene.ts",
    "E:/project/duorou/client/src/manager/GameUIManager.ts",
    "E:/project/duorou/client/src/game/ray/SceneRayChecker.ts",
    "E:/project/duorou/client/src/game/ui/LoadingScenes.ts"
  ],
  "map": "{\"version\":3,\"file\":\"CameraAnimation.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/game/CameraAnimation.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
