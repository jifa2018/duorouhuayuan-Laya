{
  "code": "import { ui } from \"../../../ui/layaMaxUI\";\r\nimport { DefaultStatue_Cfg, ConfigManager, Statue_Cfg } from \"../../../manager/ConfigManager\";\r\nimport { IndexDecorateItem } from \"./indexDecorateItem\";\r\nimport { BottomCreater } from \"../../item/BottomCreater\";\r\nimport { Player } from \"../../player/Player\";\r\nexport class IndexDecorateView extends ui.view.decorate.indexDecorateUI {\r\n    constructor() {\r\n        super();\r\n        this.mDecorateItem = new Map();\r\n        this.nList = ConfigManager.prototype.GetJsonToArray(DefaultStatue_Cfg);\r\n        this.nStatue = ConfigManager.prototype.GetJsonToArray(Statue_Cfg);\r\n    }\r\n    onEnable() {\r\n        this.init();\r\n        this.initList().then(() => {\r\n            this.createList();\r\n            this.refreshList();\r\n        });\r\n    }\r\n    onDestroy() {\r\n        this.mDecorateItem.forEach((e, i) => {\r\n            let item = e;\r\n            item.onDestroy();\r\n        });\r\n    }\r\n    init() {\r\n        this.panel.vScrollBarSkin = \"\";\r\n        this.width = 600;\r\n        this.height = 440;\r\n        this.x = Laya.stage.width / 2 - this.width / 2;\r\n        this.y = Laya.stage.height / 2 - this.height / 2;\r\n    }\r\n    initList() {\r\n        var self = this;\r\n        return new Promise(function (resolve, reject) {\r\n            Laya.loader.load(\"prefab/decorateList.json\", Laya.Handler.create(self, function (pref) {\r\n                for (let index = 0; index < this.nList.length; index++) {\r\n                    let ele = this.nList[index];\r\n                    let _indexDecorateItem = new IndexDecorateItem(pref, index, this, ele.strNodeName);\r\n                    _indexDecorateItem.setTitle(\"装饰点\" + (index + 1));\r\n                    _indexDecorateItem.setMoreEvent();\r\n                    this.mDecorateItem.set(ele.strNodeName, _indexDecorateItem);\r\n                    this.panel.addChild(_indexDecorateItem.getList);\r\n                }\r\n                resolve();\r\n            }));\r\n        });\r\n    }\r\n    createList() {\r\n        this.mDecorateItem.forEach((e, i) => {\r\n            let list = e.getList;\r\n            list.array = [];\r\n            list.renderHandler = Laya.Handler.create(this, this.renderList, [e], false);\r\n            list.mouseHandler = Laya.Handler.create(this, this.eventList, [e], false);\r\n        });\r\n    }\r\n    refreshList() {\r\n        let offsetH = 20;\r\n        let calcY = offsetH;\r\n        this.mDecorateItem.forEach((e, i) => {\r\n            let obj = this.getTabDecorate();\r\n            let _item = e;\r\n            obj = this.extendArrDecorate(_item, obj);\r\n            _item.setArray(obj);\r\n            _item.setMoreState();\r\n            let _list = _item.getList;\r\n            _item.setPos(this.panel.width / 2 - _list.width / 2, calcY);\r\n            calcY += _list.height + offsetH;\r\n            console.log(\"刷新列表\", _item, \"arrDecorate\", obj);\r\n        });\r\n    }\r\n    renderList(decItem, cell, index) {\r\n        decItem.renderList(cell, index);\r\n    }\r\n    eventList(decItem, e) {\r\n        decItem.eventList(e);\r\n    }\r\n    getTabDecorate() {\r\n        let obj = {\r\n            arrDecorate: []\r\n        };\r\n        this.nStatue.forEach((element, index) => {\r\n            if (element.StatueType == 2) {\r\n                obj.arrDecorate.push(element);\r\n            }\r\n        });\r\n        return obj;\r\n    }\r\n    extendArrDecorate(item, obj) {\r\n        let _data = obj.arrDecorate;\r\n        let bottomList = BottomCreater.getInstance().getBottomList();\r\n        let unLock = [];\r\n        let _curDecorateId = null;\r\n        let _lv = 0;\r\n        let extend = { unLock: [], selected: [], isMeet: [] };\r\n        bottomList.forEach((e, i) => {\r\n            if (item.name == e._name) {\r\n                unLock = e._unLockDecorates;\r\n                _curDecorateId = e._curDecorateId;\r\n                _lv = e._level;\r\n            }\r\n        });\r\n        for (let index = 0; index < _data.length; index++) {\r\n            const element = _data[index];\r\n            if (_curDecorateId == element.id && extend[\"selected\"].indexOf(element.id) == -1) {\r\n                extend[\"selected\"].push(element.id);\r\n            }\r\n            if (extend[\"unLock\"].indexOf(element.id) == -1) {\r\n                if (unLock.indexOf(element.id) != -1) {\r\n                    extend[\"unLock\"].push(element.id);\r\n                    continue;\r\n                }\r\n            }\r\n            else {\r\n                continue;\r\n            }\r\n            let vNum = 0;\r\n            if (element.UnlockGold <= Player.getInstance().nGold)\r\n                vNum++;\r\n            if (element.UnlockStar <= Player.getInstance().nStar)\r\n                vNum++;\r\n            if (element.UnlockLv <= _lv)\r\n                vNum++;\r\n            if (element.unLock || vNum == 3 && extend[\"isMeet\"].indexOf(element.id) == -1) {\r\n                extend[\"isMeet\"].push(element.id);\r\n            }\r\n            obj[\"extend\"] = extend;\r\n        }\r\n        return obj;\r\n    }\r\n}\r\n//# sourceMappingURL=IndexDecorateView.js.map",
  "references": [
    "E:/project/duorou/client/src/ui/layaMaxUI.ts",
    "E:/project/duorou/client/src/manager/ConfigManager.ts",
    "E:/project/duorou/client/src/game/ui/Decorate/indexDecorateItem.ts",
    "E:/project/duorou/client/src/game/item/BottomCreater.ts",
    "E:/project/duorou/client/src/game/player/Player.ts"
  ],
  "map": "{\"version\":3,\"file\":\"IndexDecorateView.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/game/ui/Decorate/IndexDecorateView.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
