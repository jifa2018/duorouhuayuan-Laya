{
  "code": "import SceneBase from \"./SceneBase\";\r\nvar Handler = Laya.Handler;\r\nimport MouseController from \"../script/MouseController\";\r\nvar Vector3 = Laya.Vector3;\r\nimport { Global } from \"../../utils/Global\";\r\nimport { GameUIManager } from \"../../manager/GameUIManager\";\r\nimport { Utils } from \"../../utils/Utils\";\r\nimport { ResourceManager } from \"../../manager/ResourceManager\";\r\nexport default class GameScene extends SceneBase {\r\n    constructor() {\r\n        super();\r\n        this.curSceneIndex = 0;\r\n        this.movePath = new Array();\r\n    }\r\n    static get instance() {\r\n        if (!GameScene._instance)\r\n            GameScene._instance = new GameScene();\r\n        return GameScene._instance;\r\n    }\r\n    showScene(param, handler) {\r\n        super.showScene(param, handler);\r\n        if (!this.scene3d || !this.sceneLoaded) {\r\n            Laya.loader.create(\"res/scene/mainscene/Scenes_huayuan.ls\", Handler.create(this, this.onSceneLoaded, [handler]));\r\n        }\r\n        else {\r\n            this.addChild(this.scene3d);\r\n        }\r\n    }\r\n    hideScene() {\r\n        super.hideScene();\r\n    }\r\n    onSceneLoaded(handler, scene3d) {\r\n        this.addChild(scene3d);\r\n        this.scene3d = scene3d;\r\n        if (!this.camera) {\r\n            this.camera = scene3d._cameraPool[0];\r\n            this.addBloom();\r\n            this.initPath();\r\n            this.script3d = this.camera.addComponent(MouseController);\r\n            this.script3d.rotateEnable = false;\r\n            this.script3d.moveEnable = true;\r\n            this.script3d.scaleEnable = false;\r\n            Global.gameCamera = this.camera;\r\n            this.loadPlant();\r\n            GameUIManager.instance.openUI(\"SwitchScene\");\r\n        }\r\n    }\r\n    addBloom() {\r\n        Utils.createBloom(this.camera, { intensity: 4, threshold: 1.1, softKnee: 0.5, clamp: 65472, diffusion: 5, anamorphicRatio: 0.0, color: new Laya.Color(1, 0.84, 0, 1), fastMode: true });\r\n    }\r\n    loadPlant() {\r\n        ResourceManager.instance.getResource(\"res/plant/Succulent_zu01.lh\", Handler.create(this, function (sp3d) {\r\n            var plantNode = this.scene3d.getChildByName(\"Duorou_zy_01\");\r\n            sp3d.transform.position = plantNode.transform.position;\r\n            sp3d.transform.rotate(new Vector3(0, 180, 0), true, false);\r\n            this.scene3d.addChild(sp3d);\r\n            this.script3d.setCameraCenter(sp3d);\r\n        }));\r\n    }\r\n    getScene() {\r\n        return this.scene3d;\r\n    }\r\n    canMove(direction) {\r\n        if (direction == \"right\") {\r\n            if (this.curSceneIndex > 0) {\r\n                this.curSceneIndex -= 1;\r\n                return true;\r\n            }\r\n            else\r\n                return false;\r\n        }\r\n        else if (direction == \"left\") {\r\n            if (this.curSceneIndex > 0)\r\n                return false;\r\n            else {\r\n                this.curSceneIndex += 1;\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    get path() {\r\n        return this.movePath;\r\n    }\r\n    initPath() {\r\n        var pathNode = this.scene3d.getChildByName(\"Role_node\");\r\n        for (var i = 0; i < pathNode.numChildren; ++i) {\r\n            this.movePath.push(pathNode.getChildAt(i).transform.position);\r\n        }\r\n    }\r\n}\r\nGameScene._instance = null;\r\n",
  "references": [
    "E:/project/duorou/client/src/game/scene/SceneBase.ts",
    "E:/project/duorou/client/src/game/script/MouseController.ts",
    "E:/project/duorou/client/src/game/script/MoveController.ts",
    "E:/project/duorou/client/src/game/npc/SaunterNpc.ts",
    "E:/project/duorou/client/src/utils/Global.ts",
    "E:/project/duorou/client/src/manager/GameUIManager.ts",
    "E:/project/duorou/client/src/utils/Utils.ts",
    "E:/project/duorou/client/src/manager/ResourceManager.ts"
  ]
}
