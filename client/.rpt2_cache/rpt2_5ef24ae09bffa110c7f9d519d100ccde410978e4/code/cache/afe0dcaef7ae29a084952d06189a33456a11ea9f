{
  "code": "import SceneBase from \"./SceneBase\";\r\nvar Handler = Laya.Handler;\r\nimport { Utils } from \"../../utils/Utils\";\r\nimport { GameUIManager } from \"../../manager/GameUIManager\";\r\nimport { ResourceManager } from \"../../manager/ResourceManager\";\r\nvar Vector3 = Laya.Vector3;\r\nvar PhysicsCollider = Laya.PhysicsCollider;\r\nvar Event = Laya.Event;\r\nvar MouseManager = Laya.MouseManager;\r\nvar Point = Laya.Point;\r\nvar Ray = Laya.Ray;\r\nvar Vector2 = Laya.Vector2;\r\nvar HitResult = Laya.HitResult;\r\nexport class DIYScene extends SceneBase {\r\n    constructor() {\r\n        super();\r\n        this.point = new Vector2();\r\n        Laya.stage.on(Event.MOUSE_DOWN, this, this.onTest);\r\n        Laya.stage.on(Event.MOUSE_MOVE, this, this.onTestMove);\r\n        Laya.stage.on(Event.MOUSE_UP, this, this.onTestUp);\r\n    }\r\n    static get instance() {\r\n        if (!DIYScene._instance)\r\n            DIYScene._instance = new DIYScene();\r\n        return DIYScene._instance;\r\n    }\r\n    showScene(param, handler) {\r\n        super.showScene(param, handler);\r\n        if (!this.scene3d || !this.sceneLoaded) {\r\n            Laya.loader.create(\"res/scene/viewscene/Scenes_duorou.ls\", Handler.create(this, this.onSceneLoaded, [handler]));\r\n        }\r\n        else {\r\n            this.addChild(this.scene3d);\r\n        }\r\n        GameUIManager.instance.openUI(\"DiyView\");\r\n    }\r\n    onSceneLoaded(handler, scene3d) {\r\n        this.scene3d = scene3d;\r\n        this.addChild(scene3d);\r\n        this.loadPlant();\r\n        this.loadPotted();\r\n        this.camera = scene3d._cameraPool[0];\r\n    }\r\n    loadPotted(isNew = true) {\r\n        var url;\r\n        if (isNew)\r\n            url = \"res/potted/a1/Succulent_pen_01.lh\";\r\n        else\r\n            url = \"res/potted/a1/Succulent_pen_01.lh\";\r\n        ResourceManager.instance.getResource(url, Handler.create(this, function (sp3d) {\r\n            this.scene3d.addChild(sp3d);\r\n            sp3d.transform.position = new Vector3(0, 0, 0);\r\n        }));\r\n    }\r\n    loadPlant() {\r\n        ResourceManager.instance.getResource(\"res/plant/Succulent_01.lh\", Handler.create(this, function (sp3d) {\r\n            this.sprite3dTest = sp3d;\r\n            sp3d.transform.position = new Vector3(1, -0.2, 0);\r\n            sp3d.transform.rotationEuler = new Vector3(0, 0, 0);\r\n            let meshCollider = sp3d.addComponent(PhysicsCollider);\r\n            let meshShape = new Laya.MeshColliderShape();\r\n            meshShape.mesh = sp3d.getChildAt(1).meshFilter.sharedMesh;\r\n            meshCollider.colliderShape = meshShape;\r\n            this.scene3d.addChild(sp3d);\r\n        }));\r\n    }\r\n    onTestUp(e) {\r\n        this.testttt11 = null;\r\n    }\r\n    onTestMove(e) {\r\n        if (!this.testttt11)\r\n            return;\r\n        this.sprite3dTest.transform.position = Utils.screenToWorld(new Point(MouseManager.instance.mouseX, MouseManager.instance.mouseY), this.camera, 0.4);\r\n    }\r\n    onTest(e) {\r\n        this.point.x = MouseManager.instance.mouseX;\r\n        this.point.y = MouseManager.instance.mouseY;\r\n        var ray = new Ray(new Vector3(0, 0, 0), new Vector3(0, 0, 0));\r\n        var outHitResult = new HitResult();\r\n        var arr = new Array();\r\n        this.camera.viewportPointToRay(this.point, ray);\r\n        this.scene3d.physicsSimulation.rayCast(ray, outHitResult);\r\n        if (outHitResult.succeeded) {\r\n            console.log(\"碰撞到物体！！\");\r\n            this.testttt11 = outHitResult.collider.owner;\r\n        }\r\n    }\r\n}\r\nDIYScene._instance = null;\r\n",
  "references": [
    "E:/project/duorou/client/src/game/scene/SceneBase.ts",
    "E:/project/duorou/client/src/utils/Utils.ts",
    "E:/project/duorou/client/src/manager/GameUIManager.ts",
    "E:/project/duorou/client/src/manager/ResourceManager.ts",
    "E:/project/duorou/client/src/game/item/Potted.ts"
  ]
}
