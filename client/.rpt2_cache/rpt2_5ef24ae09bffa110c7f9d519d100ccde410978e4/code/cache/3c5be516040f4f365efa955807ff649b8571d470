{
  "code": "import SceneBase from \"./SceneBase\";\r\nvar Handler = Laya.Handler;\r\nimport MouseController from \"../script/MouseController\";\r\nimport { Utils } from \"../../utils/Utils\";\r\nvar Vector3 = Laya.Vector3;\r\nvar ShadowMode = Laya.ShadowMode;\r\nimport { GameUIManager } from \"../../manager/GameUIManager\";\r\nexport default class ViewScene extends SceneBase {\r\n    constructor() {\r\n        super();\r\n    }\r\n    static get instance() {\r\n        if (!ViewScene._instance)\r\n            ViewScene._instance = new ViewScene();\r\n        return ViewScene._instance;\r\n    }\r\n    showScene(param, handler) {\r\n        super.showScene(param, handler);\r\n        if (!this.scene3d || !this.sceneLoaded) {\r\n            Laya.loader.create(\"res/scene/viewscene/Scenes_duorou.ls\", Handler.create(this, this.onSceneLoaded, [handler]));\r\n        }\r\n        else {\r\n            this.addChild(this.scene3d);\r\n        }\r\n    }\r\n    onSceneLoaded(handler, scene3d) {\r\n        this.addChild(scene3d);\r\n        if (!this.camera) {\r\n            this.light = scene3d.getChildByName(\"Spot Light (1)\");\r\n            this.ground = scene3d.getChildByName(\"Object\").getChildByName(\"dimian\");\r\n            this.ground.meshRenderer.receiveShadow = true;\r\n            this.camera = scene3d._cameraPool[0];\r\n            this.script3d = this.camera.addComponent(MouseController);\r\n            this.scene3d = scene3d;\r\n            this.script3d.rotateEnable = true;\r\n            this.script3d.moveEnable = false;\r\n            this.script3d.scaleEnable = true;\r\n            Utils.createBloom(this.camera, { intensity: 4, threshold: 1.1, softKnee: 0.5, clamp: 65472, diffusion: 5, anamorphicRatio: 0.0, color: new Laya.Color(1, 0.84, 0, 1), fastMode: true });\r\n            this.loadPlant();\r\n        }\r\n        else {\r\n            Laya.timer.once(2000, this, function () {\r\n                GameUIManager.instance.setUIVisible(\"LoadingScene\", false);\r\n            });\r\n        }\r\n    }\r\n    loadPlant() {\r\n        Laya.loader.create(\"res/plant/Succulent_zu01.lh\", Handler.create(this, function (sp3d) {\r\n            sp3d = sp3d.clone();\r\n            sp3d.transform.position = new Vector3(0, -0.2, 0);\r\n            sp3d.transform.rotationEuler = new Vector3(0, 0, 0);\r\n            this.scene3d.addChild(sp3d);\r\n            Utils.setMeshCastShadow(sp3d, true);\r\n            this.script3d.setCameraCenter(sp3d);\r\n            this.script3d.setTarget(sp3d);\r\n            this.light.shadowMode = ShadowMode.Hard;\r\n            this.light.shadowDistance = 4;\r\n            this.light.shadowResolution = 1024;\r\n            this.light.shadowDepthBias = 1.0;\r\n            this.light.shadowStrength = 0.6;\r\n            this.light.shadowNearPlane = 0.001;\r\n            Laya.timer.once(2000, this, function () {\r\n                GameUIManager.instance.setUIVisible(\"LoadingScene\", false);\r\n                GameUIManager.instance.openUI(\"DiyView\");\r\n            });\r\n        }));\r\n    }\r\n}\r\nViewScene._instance = null;\r\n",
  "references": [
    "E:/project/duorou/client/src/game/scene/SceneBase.ts",
    "E:/project/duorou/client/src/game/script/MouseController.ts",
    "E:/project/duorou/client/src/utils/Utils.ts",
    "E:/project/duorou/client/src/manager/GameUIManager.ts",
    "E:/project/duorou/client/src/game/ui/DiyView/DiyView.ts"
  ]
}
