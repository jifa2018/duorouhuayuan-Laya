{
  "code": "var Sprite3D = Laya.Sprite3D;\r\nimport { ResourceManager } from \"../../manager/ResourceManager\";\r\nvar Handler = Laya.Handler;\r\nimport { Statue_Cfg } from \"../../manager/ConfigManager\";\r\nimport { BottomCreater } from \"./BottomCreater\";\r\nimport { Effect3D } from \"../../effect/Effect3D\";\r\nexport class Decorate extends Sprite3D {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.state = false;\r\n        this.time = 0;\r\n        this._rotateTime = 0;\r\n        this._stopTime = 0;\r\n        this._effect = null;\r\n        this._effectUrl = \"\";\r\n        this._indicateEffect = null;\r\n        this._nT = 1000;\r\n    }\r\n    init(id) {\r\n        var url = Statue_Cfg[id].strStatueModel;\r\n        this._id = id;\r\n        ResourceManager.getInstance().getResource(url, Handler.create(this, this.onDecorateLoaded));\r\n    }\r\n    setInfo(_data, rT, sT) {\r\n        if (_data) {\r\n            this.state = _data.state;\r\n            this.time = _data.time ? _data.time : 0;\r\n        }\r\n        this._rotateTime = rT * 1000;\r\n        this._stopTime = sT * 1000;\r\n    }\r\n    onChangeModel(id) {\r\n        var url = Statue_Cfg[id].strStatueModel;\r\n        this._id = id;\r\n        Laya.timer.clearAll(this);\r\n        ResourceManager.getInstance().getResource(url, Handler.create(this, this.onDecorateLoaded));\r\n    }\r\n    onDecorateLoaded(decorate) {\r\n        this._model && this._model.destroy();\r\n        this._model = null;\r\n        this._model = decorate;\r\n        this.addChild(decorate);\r\n        this.behavior();\r\n    }\r\n    behavior() {\r\n        Laya.timer.loop(this._nT, this, () => {\r\n            if (isNaN(this.time)) {\r\n                this.time = 0;\r\n            }\r\n            if (this.time == 0) {\r\n                BottomCreater.getInstance().refreshData();\r\n            }\r\n            if (this.state) {\r\n                this.createEffect();\r\n                this.rotateBehavior();\r\n                return;\r\n            }\r\n            else {\r\n                Laya.Tween.clearAll(this);\r\n                this.stopState();\r\n                this.disableEffect();\r\n                return;\r\n            }\r\n        });\r\n    }\r\n    stopState() {\r\n        this.time += this._nT;\r\n        if (this.time >= this._stopTime) {\r\n            this.state = true;\r\n            this.time = 0;\r\n        }\r\n    }\r\n    rotateBehavior() {\r\n        this.time += this._nT;\r\n        if (this.time >= this._rotateTime) {\r\n            this.state = false;\r\n            this.time = 0;\r\n        }\r\n        let rot = new Laya.Vector3(this._model.transform.rotationEuler.x, this._model.transform.rotationEuler.y + 20, this._model.transform.rotationEuler.z);\r\n        Laya.Tween.to(this._model.transform.rotationEuler, {\r\n            x: rot.x, y: rot.y, z: rot.z, update: new Handler(this, function () {\r\n                if (!this._model || !this._model.transform) {\r\n                    Laya.Tween.clearAll(this);\r\n                    return;\r\n                }\r\n                this._model.transform.rotationEuler = this._model.transform.rotationEuler;\r\n            })\r\n        }, 1000);\r\n    }\r\n    addEffect(url, indicateEffect) {\r\n        this._effectUrl = url;\r\n        this._indicateEffect = indicateEffect;\r\n    }\r\n    createEffect() {\r\n        if (this._effect)\r\n            return;\r\n        this._effect = new Effect3D();\r\n        this._effect.createSceneEffect(this._effectUrl, this, this._model.transform.position, 0, true, null);\r\n        this._indicateEffect.active = true;\r\n    }\r\n    disableEffect() {\r\n        if (!this._effect)\r\n            return;\r\n        this._effect.destroy();\r\n        this._effect = null;\r\n        this._indicateEffect.active = false;\r\n    }\r\n}\r\n//# sourceMappingURL=Decorate.js.map",
  "references": [
    "E:/project/duorou/client/src/manager/ResourceManager.ts",
    "E:/project/duorou/client/src/manager/ConfigManager.ts",
    "E:/project/duorou/client/src/game/item/BottomCreater.ts",
    "E:/project/duorou/client/src/effect/Effect3D.ts"
  ],
  "map": "{\"version\":3,\"file\":\"Decorate.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/game/item/Decorate.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
