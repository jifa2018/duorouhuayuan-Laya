{
  "code": "var Vector3 = Laya.Vector3;\r\nimport { Dictionary } from \"../utils/Dictionary\";\r\nimport { Singleton } from \"../common/Singleton\";\r\nimport GameScene from \"../game/scene/GameScene\";\r\nimport { Utils } from \"../utils/Utils\";\r\nexport class PathManager extends Singleton {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.pathDic = new Dictionary();\r\n        this.collectDIc = new Dictionary();\r\n        this.collectIdleDIc = new Dictionary();\r\n        this.collectPathDic = new Dictionary();\r\n        this.collectArray = null;\r\n        this.growSpecialArray = new Array();\r\n        this.growCommonArray = new Array();\r\n    }\r\n    onInit() {\r\n        this.initPath();\r\n        this.initCollectIdle();\r\n        this.initCollectPath();\r\n    }\r\n    onUpdata() {\r\n    }\r\n    onDestroy() {\r\n    }\r\n    initPath() {\r\n        this.pathDic.clear();\r\n        var childrenNode = GameScene.instance.scene3d.getChildByName(\"path\");\r\n        if (!childrenNode) {\r\n            console.log(\"路径点为空\");\r\n            return;\r\n        }\r\n        var num = childrenNode.numChildren;\r\n        for (var i = 0; i < num; ++i) {\r\n            var childNode = childrenNode.getChildAt(i);\r\n            var arrPath = new Array();\r\n            for (var j = 0; j < childNode.numChildren; ++j) {\r\n                arrPath.push(childNode.getChildAt(j).transform.position);\r\n            }\r\n            this.pathDic.set(childNode.name, arrPath);\r\n        }\r\n    }\r\n    initCollectPath() {\r\n        this.collectPathDic.clear();\r\n        var childrenNode = GameScene.instance.scene3d.getChildByName(\"scenes1_caijipoint\");\r\n        if (!childrenNode) {\r\n            console.log(\"路径点为空\");\r\n            return;\r\n        }\r\n        var num = childrenNode.numChildren;\r\n        for (var i = 0; i < 10; ++i) {\r\n            var childNode = childrenNode.getChildAt(i);\r\n            var arrPath = new Array();\r\n            for (var j = 0; j < childNode.numChildren; ++j) {\r\n                arrPath.push(childNode.getChildAt(j).transform.position);\r\n            }\r\n            this.collectPathDic.set(childNode.name, arrPath);\r\n        }\r\n    }\r\n    initCollect() {\r\n        this.collectDIc.clear();\r\n        var childrenNode = GameScene.instance.scene3d.getChildByName(\"caijipath\").getChildByName(\"scene1\");\r\n        if (!childrenNode) {\r\n            console.log(\"路径点为空\");\r\n            return;\r\n        }\r\n        var num = childrenNode.numChildren;\r\n        for (var i = 0; i < num; ++i) {\r\n            var childNode = childrenNode.getChildAt(i);\r\n            this.collectDIc.set(childNode.name, childNode.transform.position);\r\n        }\r\n    }\r\n    initGrowPoint() {\r\n        for (var i = 1; i < 2; ++i) {\r\n            var childrenNode = GameScene.instance.scene3d.getChildByName(\"scenes\" + i.toString() + \"_caijipoint\");\r\n            var pt = childrenNode.getChildByName(\"pt\");\r\n            var num = pt.numChildren;\r\n            var arr = new Array();\r\n            for (var j = 0; j < num; ++j) {\r\n                var arrPT = new Array();\r\n                var s = pt.getChildAt(j);\r\n                for (var k = 0; k < s.numChildren; ++k) {\r\n                    arrPT.push(s.getChildAt(k).transform.position);\r\n                }\r\n                arr.push(arrPT);\r\n            }\r\n            this.growCommonArray[i] = arr;\r\n            var ts = childrenNode.getChildByName(\"ts\");\r\n            var num = ts.numChildren;\r\n            var arrTs = new Array();\r\n            for (var j = 0; j < num; ++j) {\r\n                arrTs.push(ts.getChildAt(j).transform.position);\r\n            }\r\n            this.growSpecialArray[i] = arrTs;\r\n        }\r\n    }\r\n    initCollectIdle() {\r\n        this.collectIdleDIc.clear();\r\n        var childrenNode = GameScene.instance.scene3d.getChildByName(\"rest area\");\r\n        if (!childrenNode) {\r\n            console.log(\"路径点为空\");\r\n            return;\r\n        }\r\n        var num = childrenNode.numChildren;\r\n        for (var i = 0; i < num; ++i) {\r\n            var childNode = childrenNode.getChildAt(i);\r\n            this.collectIdleDIc.set(childNode.name, [childNode.transform.position, false]);\r\n        }\r\n    }\r\n    getPathByName(name) {\r\n        return this.pathDic.has(name) ? this.pathDic.get(name) : [];\r\n    }\r\n    getCollectByName(name) {\r\n        return this.collectDIc.has(name) ? this.collectDIc.get(name) : [];\r\n    }\r\n    getCollectPathByName(name) {\r\n        name = \"path\" + name;\r\n        return this.collectPathDic.has(name) ? this.collectPathDic.get(name) : [];\r\n    }\r\n    getCollectIdleByName(name) {\r\n        if (this.collectIdleDIc.has(name.toString())) {\r\n            let path = this.collectIdleDIc.get(name);\r\n            if (path[1])\r\n                return this.getCollectIdleByName(name + 1);\r\n            else {\r\n                path[1] = true;\r\n                return path[0];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    getCollectIdleClear(pos) {\r\n        for (const key in this.collectIdleDIc.items) {\r\n            if (this.collectIdleDIc.items.hasOwnProperty(key)) {\r\n                const element = this.collectIdleDIc.items[key];\r\n                if (Vector3.equals(element[0], pos)) {\r\n                    element[1] = false;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    getAllCollect() {\r\n        if (!this.collectArray)\r\n            this.collectArray = Utils.formatObject2Array(this.collectDIc.items);\r\n        return this.collectArray;\r\n    }\r\n    getPathByDistance(pos) {\r\n        var dis = 1000;\r\n        var name;\r\n        var _dis;\r\n        var posPoint;\r\n        for (const key of Object.keys(this.pathDic.items)) {\r\n            if (this.pathDic.items.hasOwnProperty(key)) {\r\n                posPoint = this.getPathByName(key)[0];\r\n                _dis = Vector3.distance(pos, posPoint);\r\n                if (_dis < dis) {\r\n                    dis = _dis;\r\n                    name = key;\r\n                }\r\n            }\r\n        }\r\n        return name;\r\n    }\r\n    getCollectByDistance(pos, list) {\r\n        var dis = 1000;\r\n        var name;\r\n        var _dis;\r\n        var posPoint;\r\n        for (const key of Object.keys(this.collectDIc.items)) {\r\n            if (list.indexOf(key) > -1)\r\n                continue;\r\n            if (this.collectDIc.items.hasOwnProperty(key)) {\r\n                posPoint = this.getCollectByName(key);\r\n                _dis = Vector3.distance(pos, posPoint);\r\n                if (_dis < dis && _dis > 0.1) {\r\n                    dis = _dis;\r\n                    name = key;\r\n                }\r\n            }\r\n        }\r\n        return name;\r\n    }\r\n    getCollectWallName() {\r\n        return this.collectDIc.items;\r\n    }\r\n}\r\n//# sourceMappingURL=PathManager.js.map",
  "references": [
    "E:/project/duorou/client/src/utils/Dictionary.ts",
    "E:/project/duorou/client/src/common/Singleton.ts",
    "E:/project/duorou/client/src/game/scene/GameScene.ts",
    "E:/project/duorou/client/src/manager/IManager.ts",
    "E:/project/duorou/client/src/utils/Utils.ts"
  ],
  "map": "{\"version\":3,\"file\":\"PathManager.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/manager/PathManager.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
