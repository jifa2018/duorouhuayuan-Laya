{
  "code": "var Sprite3D = Laya.Sprite3D;\r\nimport { MoveController } from \"../script/MoveController\";\r\nvar Handler = Laya.Handler;\r\nvar Pool = Laya.Pool;\r\nimport { AnimatorController } from \"../script/AnimatorController\";\r\nimport { Debug } from \"../../common/Debug\";\r\nvar PhysicsCollider = Laya.PhysicsCollider;\r\nimport { Npc_Cfg, Sound_Cfg } from \"../../manager/ConfigManager\";\r\nimport { SceneItemCreater } from \"../item/SceneItemCreater\";\r\nimport { SoundManager } from \"../../manager/SoundManager\";\r\nimport GameScene from \"../scene/GameScene\";\r\nimport { Utils } from \"../../utils/Utils\";\r\nexport class NpcBase extends Sprite3D {\r\n    constructor() {\r\n        super();\r\n        this.clickIndex = 0;\r\n        this.pickUpMoneySpeed = 1000;\r\n        this.Cruise_speed = 2;\r\n        this.alphaValue = 0.5;\r\n    }\r\n    onLoad() { }\r\n    onMove() { }\r\n    onStop() { }\r\n    onUpdate() {\r\n        if (this.state) {\r\n            this.state.Update();\r\n        }\r\n    }\r\n    onDestroy() { }\r\n    createById(tableId) {\r\n        this._tableData = Npc_Cfg[tableId];\r\n        if (!this._tableData) {\r\n            console.log(\"npc表中没有id = \" + tableId.toString());\r\n            return;\r\n        }\r\n        this.type = this._tableData.type;\r\n        this.Cruise_speed = this._tableData.Cruise_speed;\r\n    }\r\n    cloneThis(sp3d) {\r\n        this.sprite3dNode = sp3d.clone();\r\n        this._moveController = this.addComponent(MoveController);\r\n        this._animator = this.addComponent(AnimatorController);\r\n        this.addChild(this.sprite3dNode);\r\n    }\r\n    recover() {\r\n        this.sprite3dNode.destroy();\r\n        this.sprite3dNode = null;\r\n        Pool.recover(this.clsName, this);\r\n    }\r\n    playAnimation(name) {\r\n        this._animator.play(name);\r\n    }\r\n    moveTo(path, complate) {\r\n        if (this._moveController) {\r\n            this._moveController.moveTo(path, complate);\r\n        }\r\n    }\r\n    get isMove() {\r\n        return !this._moveController ? false : this._moveController.isMove;\r\n    }\r\n    set isMove(b) {\r\n        if (this._moveController) {\r\n            this._moveController.isMove = b;\r\n        }\r\n    }\r\n    onClick() {\r\n    }\r\n    ChangeState(state) {\r\n        if (this.state != null) {\r\n            this.state.Exit();\r\n        }\r\n        this.state = state;\r\n        if (this.state != null) {\r\n            this.state.Enter();\r\n        }\r\n    }\r\n    GetType() {\r\n        if (this.state != null) {\r\n            return this.state.GetType();\r\n        }\r\n    }\r\n    GetCamera() {\r\n    }\r\n    set clickEnable(b) {\r\n        if (this.sprite3dNode) {\r\n            this.setClickEnable(b);\r\n        }\r\n    }\r\n    setClickEnable(b) {\r\n        var c = this.sprite3dNode.getComponent(PhysicsCollider);\r\n        if (c)\r\n            c.enabled = b;\r\n        else\r\n            console.log(\"角色没有碰撞盒\");\r\n    }\r\n    GetstealGold(target, range = 1) {\r\n        var nearItem = SceneItemCreater.getInstance().getNearItem(this.transform.position, range);\r\n        if (nearItem == null || nearItem == undefined) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    stealGold(target, range = 1, hander) {\r\n        var nearItem = SceneItemCreater.getInstance().getNearItem(this.transform.position, range);\r\n        if (!nearItem) {\r\n            hander && hander.runWith(false);\r\n            return;\r\n        }\r\n        this.moveTo([nearItem.transform.position], Handler.create(this, function () {\r\n            Laya.timer.once(this.pickUpMoneySpeed, this, () => {\r\n                SoundManager.getInstance().playSound(Sound_Cfg[1].strsound);\r\n                var v2 = Utils.worldToScreen(GameScene.instance.camera, nearItem.pos);\r\n                Utils.createNumberText(nearItem.addGold.toString(), v2.x, v2.y, \"-\", false);\r\n                nearItem.onClick();\r\n                hander && hander.runWith(true);\r\n            });\r\n        }));\r\n    }\r\n    changMoveSpeed(speed) {\r\n        this._moveController.changSpeed(speed);\r\n    }\r\n    LookAtPoint(pointName) {\r\n        let point = GameScene.instance.scene3d.getChildByName(\"point\").getChildByName(pointName);\r\n        if (point == null) {\r\n            Debug.Log(\"没有找到可以看向的多肉点！！！！！！！！！！！！！！\");\r\n            return;\r\n        }\r\n        let disX = point.transform.position.x - this.transform.position.x;\r\n        let disZ = point.transform.position.z - this.transform.position.z;\r\n        if (this.transform != null || this.transform != undefined) {\r\n            this.transform.localRotationEulerY = Math.atan2(disX, disZ) * 180 / Math.PI;\r\n        }\r\n    }\r\n    paymoneycallBack() {\r\n        if (!this.sprite3dNode || this.sprite3dNode.destroyed) {\r\n            return;\r\n        }\r\n        let offset = 0.5 / ((this._tableData.disappear_time / 0.5) + 1);\r\n        this.SetModelAlpha(this.alphaValue - offset);\r\n        if (this.alphaValue <= 0) {\r\n            Laya.timer.clear(this, this.paymoneycallBack);\r\n            this._aiController.onStop();\r\n        }\r\n    }\r\n    disappear() {\r\n        this._moveController.changSpeed(this._tableData.disappear_speed);\r\n        this.alphaValue = 0.5;\r\n        this.paymoneycallBack();\r\n        Laya.timer.loop(500, this, this.paymoneycallBack);\r\n    }\r\n    escape(hander) { }\r\n    ActionDone() { }\r\n    changActionSite(id) { }\r\n    GetActionSite() { return this.ActionSite; }\r\n    SetModelAlpha(alphaValue) {\r\n        this.alphaValue = alphaValue;\r\n        Utils.setModelAlpha(this.sprite3dNode, this.alphaValue);\r\n    }\r\n}\r\n//# sourceMappingURL=NpcBase.js.map",
  "references": [
    "E:/project/duorou/client/src/game/npc/INpc.ts",
    "E:/project/duorou/client/src/game/script/MoveController.ts",
    "E:/project/duorou/client/src/game/script/AnimatorController.ts",
    "E:/project/duorou/client/src/game/npc/npcstate/NPCBaseState.ts",
    "E:/project/duorou/client/src/common/Debug.ts",
    "E:/project/duorou/client/src/game/item/SceneItem.ts",
    "E:/project/duorou/client/src/game/ai/AIBase.ts",
    "E:/project/duorou/client/src/manager/ConfigManager.ts",
    "E:/project/duorou/client/src/game/item/SceneItemCreater.ts",
    "E:/project/duorou/client/src/manager/SoundManager.ts",
    "E:/project/duorou/client/src/game/scene/GameScene.ts",
    "E:/project/duorou/client/src/utils/Utils.ts"
  ],
  "map": "{\"version\":3,\"file\":\"NpcBase.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/game/npc/NpcBase.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
